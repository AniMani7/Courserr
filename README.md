Final implementation is in this repository
